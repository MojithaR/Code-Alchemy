/*CREATING TABLES */

CREATE TABLE PRODUCT (
proID CHAR(5) NOT NULL,
proNAME VARCHAR(20) NOT NULL,
qty INT CHECK (qty >0),
unitPRICE INT CHECK (unitPRICE >0) NOT NULL,
ROL INT NOT NULL,
supplier INT NOT NULL,
CONSTRAINT PRODUCT_PK PRIMARY KEY(proID),
CONSTRAINT SUPPLIER_IN_PRODUCT_TABLE_FK FOREIGN KEY(supplier) REFERENCES SUPPLIER(supID) 
);

CREATE TABLE CUSTOMER(
custID CHAR(4) NOT NULL,
custNAME VARCHAR(20) NOT NULL,
adress VARCHAR(10) NOT NULL,
custPhone VARCHAR(10) NOT NULL,
loyaltyPoints INT ,
CONSTRAINT CUSROMEER_pk PRIMARY KEY(custID),
CONSTRAINT CUSTOMER_CHECK CHECK ( custPhone LIKE '[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]'),
);

CREATE TABLE STAFF(
staffID CHAR(4) NOT NULL,
staffName VARCHAR(20) NOT NULL,
staffPhone VARCHAR(10) NOT NULL,
CONSTRAINT STAFF_PK PRIMARY KEY(staffID),
CONSTRAINT phone_check CHECK ( staffPhone LIKE '[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9] '),
);

CREATE TABLE SALES (
proID CHAR(5) NOT NULL,
custID CHAR(4) NOT NULL,
staffID CHAR(4) NOT NULL,
salesDATE DATE DEFAULT GETDATE() NOT NULL,
CONSTRAINT staffID_IN_SALES_TABLE_FK FOREIGN KEY (staffID) REFERENCES STAFF (staffID),
CONSTRAINT proID_IN_SALES_TABLE_FK FOREIGN KEY(proID) REFERENCES PRODUCT ( proID),
CONSTRAINT custID_IN_SALES_TABLE_FK FOREIGN KEY(custID) REFERENCES CUSTOMER (custID)
);

CREATE TABLE SUPPLIER (
supID INT NOT NULL,
contactName VARCHAR(20) NOT NULL,
supplierAdress VARCHAR(10) NOT NULL,
supplierPhone VARCHAR(10) NOT NULL,
CONSTRAINT supplierPhone_CHECK CHECK (supplierPhone LIKE '[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9] '),
CONSTRAINT SUPLLIER_PK PRIMARY KEY (supID)
);

/*INSERT GIVVEN DATA*/

INSERT INTO PRODUCT VALUES ('P0001' , 'Lemon Puff ', '22' , '85' , '20' , '1');
INSERT INTO PRODUCT VALUES ('P0201' , 'Knor soup', '8' , '100' , '10' , '2');
INSERT INTO PRODUCT VALUES ('P0084' , 'Lipton Ceylonta', '12' , '125' , '15' , '2');
INSERT INTO PRODUCT VALUES ('P0222' , 'chocolate fingers', '14' , '50' , '8' , '1');

INSERT INTO CUSTOMER VALUES ( 'C100' , 'Ravi Perera' , 'Colombo' , '0112123456', '1200' );
INSERT INTO CUSTOMER VALUES ( 'C101' , 'Nimali Alwis' , 'Gampaha' , '0332212345', '275' );

INSERT INTO STAFF VALUES ('S001' , 'Kamal Silva' , '0718123456' );
INSERT INTO STAFF VALUES ('S002' , 'Amila Namal' , '0714222222' );

INSERT INTO SALES VALUES ('P0201' , 'C100' , 'S001', '13/11/2015' );
INSERT INTO SALES VALUES ('P0222' , 'C101' , 'S002', '22/11/2015' );
INSERT INTO SALES VALUES ('P0084' , 'C100' , 'S001', '01/12/2015' );
INSERT INTO SALES VALUES ('P0201' , 'C100' , 'S002', '08/12/2015' );

INSERT INTO SUPPLIER VALUES ('1' , 'Amal Ranjith' , 'Rathmalana' , '0112111111' );
INSERT INTO SUPPLIER VALUES ('2' , 'Nadeeka Perera' , 'Borella' ,  '0114555666' );